{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "postUpgradeTasks": {
    "commands": ["./scripts/refresh-deps.sh"],
    "fileFilters": [
      "pyproject.toml",
      "uv.lock",
      "docs/starlight/package.json",
      "docs/starlight/package-lock.json"
    ],
    "executionMode": "branch"
  },
  "packageRules": [
    {
      "matchManagers": ["github-actions"],
      "pinDigests": true,
      "description": "Ensure GitHub Actions are always pinned to exact commit SHAs."
    },
    {
      "description": "Refresh lockfiles when Python dependencies change",
      "matchManagers": ["pip_setup"],
      "postUpgradeTasks": {
        "commands": ["./scripts/refresh-deps.sh"],
        "fileFilters": ["pyproject.toml", "uv.lock"],
        "executionMode": "branch"
      }
    },
    {
      "description": "Keep Starlight lockfile aligned with package updates",
      "matchManagers": ["npm"],
      "matchFileNames": ["docs/starlight/**"],
      "postUpgradeTasks": {
        "commands": ["./scripts/refresh-deps.sh"],
        "fileFilters": [
          "docs/starlight/package.json",
          "docs/starlight/package-lock.json"
        ],
        "executionMode": "branch"
      }
    }
  ]
}
